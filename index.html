<!DOCTYPE html>

<html>
<title>Wiki-suggestions</title>    

<head> 

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    
    <script src="https://use.fontawesome.com/c4baa82464.js"></script>        
    <script src="https://code.jquery.com/jquery-3.1.1.js" integrity="sha256-16cdPddA6VdVInumRGo6IbivbERE8p7CQR3HzTBuELA=" crossorigin="anonymous"></script>
        
</head>
    
<style>

    html, body{
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
    }
    
    .margin{
        margin: 10px;
    }
    
    #flex-container{
        position: relative;
        display: flex;
        flex-direction: column;
        flex-wrap: nowrap;
        align-items: center;
        justify-content: center;
        margin-top: 10%;
    }
    
    #form-cont{
        background-color: blanchedalmond;
    }
    
    #big-folder{
        position: fixed;
        z-index: 2;
        height: 100%;
        width: 50%;
        left: 50%;
        background-color: rgba(245, 245, 220, 0.2);
    }
    
    #proto-box{
        display: none;
    }
    
    .result-box{
        position: relative;
        left: 250px;
        width: 250px;
        height: 250px;
        min-width: 250px;
        min-height: 250px;  
        overflow: scroll;
        border-radius: 10px;
        border: solid 1px #dae3ef;
        
        -webkit-transition: all 1s ease; /* Safari */
        transition: all 1s ease;
    }
    
    .result-box.pop-left{
        animation: leftpop 1s ease-out;
        animation-fill-mode: forwards;
    }
 
    @keyframes leftpop{
        0%{left:250px;}
        50%{left: -50px;}
        100%{left: 30px;}
    }
    
    .result-box h4{
        position: absolute;
        width: 105%;
        height: 50px;
        background-color: #dae3ef;
        top: 30%;
        left: calc(-50% + 25px);
        padding: 10px;
        margin-left: -5%;
        text-align: center;
        
        -webkit-transform:rotate(-90deg);
        -moz-transform:rotate(-90deg);
        -o-transform: rotate(-90deg);
        -ms-transform:rotate(-90deg);
        transform: rotate(-90deg);
    }
    
   .result-box:hover{
        margin-left: -150px; 
    }
    

    @media all and (max-width:768px), all and (max-height:350px)
    {
             
    }
    
</style>    
    
<body>
    
    <div id="flex-container">
        
        <div id="big-folder">
            <form id="form-cont" class="margin">
            <input id="search-bar" type="text" placeholder="enter your search keyword" />
        </form>
        </div>
        
        <div id="proto-box" class="result-box margin">
            <div>
                <p></p>
                <h4></h4>
            </div>
        </div>
        
    </div>
    
    <script>
        
    $(document).ready(function(){
        
        var maxResults = 5;
        var resultHeaders;
        var resultDescr;
        var resultLinks;
        var holdNewSearches = false;
        
        $("form").on("submit", function(e){
            
            e.preventDefault();
            
            if(!holdNewSearches)
            {
                holdNewSearches = true;
                foldPreviousSearch();
            }
        });
        
        function foldPreviousSearch()
        {
            console.log($(".result-box:not(#proto-box)").length);
            
            $(".result-box:not(#proto-box)").fadeOut();
            
            setTimeout(function(){
                performSearch($("#search-bar").val());                    
            }, 2000);
        }
            
        function performSearch(search){            

            $.ajax({
                type: "GET",
                url: "http://en.wikipedia.org/w/api.php?action=opensearch&format=json&limit="+maxResults+"&search="+search+"&callback=?",
                contentType: "application/json; charset=utf-8",
                async: false,
                dataType: "json",
                success: function (data, textStatus, jqXHR) {
                    resultHeaders = data[1].slice();
                    resultDescr = data[2].slice();
                    resultLinks = data[3].slice();
                    generateResults();
                },
                error: function (errorMessage) {
                }
            });
        }
        
        function generateResults()
        {               
            for(var i=0; i < resultHeaders.length; i++)
            {
                var $cloneBox = $("#proto-box").clone(true);

                $cloneBox.removeAttr("id");
                $cloneBox.css("order", i);
                $cloneBox.find("h4").text(resultHeaders[i]);
                $cloneBox.find("p").text(resultDescr[i]);
                $("#flex-container").append($cloneBox);
            }
                        
            $(".result-box:not(#proto-box)").each(function(idx){
                $(this).delay(idx * 300).queue(function(){
                    $(this).addClass("pop-left");
                    if(idx >= $(".result-box:not(#proto-box)").length - 1)
                    {
                        holdNewSearches = false;
                    }
                });
            });
        }
        
    });

    </script>   
    
</body>
    
</html>